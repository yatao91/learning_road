## **一、前言**

Linux 的安全性很高，它完善的用户和权限管理机制功不可没。

妥善管理好 Linux 系统上的用户和组是 Linux 系统管理员的义务。

本文以 CentOS 7.4.1708 为例，其他 Linux 发行版部分内容可能会有所不同。

------

## **二、用户管理**

## **2.1 用户的类型**

在 Linux 系统中，有三种用户。

## **2.1.1 超级用户**

用户名为 root，用户 ID 为 0。有着至高无上的权限，可执行所有任务，可访问所有文件，可管理所有用户。

在服务器配置工作完毕后，为了安全，不应该直接使用超级用户。

## **2.1.2 普通用户**

用户 ID 默认从 1000 开始。供普通用户使用。

## **2.1.3 系统服务用户**

用户 ID 默认为 1-499。仅供系统服务使用，默认不可登录（即默认 SHELL 为 /sbin/nologin）。

## **2.2 查看本机用户信息**

## **2.2.1 /etc/passwd**

文件的格式如下：

```text
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
...
```

该文件以 : 作为字段分隔符，保存了本机所有用户的基本信息。以下详细说明其含义。



![img](https://pic4.zhimg.com/80/v2-e50d59a5cf082b197b7f5a94c0ded483_hd.jpg)

在早期的 Linux 系统中，密码是保存在这个文件里的。但是该文件默认所有用户都可读，会对系统安全造成威胁。现在，密码都以散列的形式存储在了 /etc/shadow 中了。

## **2.2.2 /etc/shadow**

文件的格式如下：

```text
root:$6$3Cprk6.h$Ied2v...:17438:0:99999:7:::
bin:*:17110:0:99999:7:::
...
```

该文件默认的权限为 000，也就是所有用户都不可访问（root 肯定可以访问，但是不建议直接修改此文件）。

该文件同样以 : 作为字段分隔符，保存了本机所有用户有关密码以及安全的信息。以下详细说明其含义。

![img](https://pic2.zhimg.com/80/v2-4ed531a70c35847251c571a0aaebecd9_hd.jpg)



## **2.3 添加用户**

**命令用法**

```text
useradd [选项] <用户名>
```

![img](https://pic1.zhimg.com/80/v2-6b9873c0529fb450fff23bbede5ea338_hd.jpg)

## **2.4 删除用户**

**命令用法**

```text
userdel [选项] <用户名>
```

![img](https://pic1.zhimg.com/80/v2-d4274c789985196eff2b177293d73850_hd.jpg)

## **2.5 修改用户参数**

**命令用法**

```text
usermod [选项] <用户名>
```



![img](https://pic3.zhimg.com/80/v2-f0cfdbdc1428954cb73ad3c889b4f652_hd.jpg)

## **2.6 用户密码及安全管理**

**命令用法**

```text
passwd [选项] <用户名>
```



![img](https://pic2.zhimg.com/80/v2-22f61e1d697707ef2a7bc42c5212a1ad_hd.jpg)

## **2.7 切换到某一用户执行命令**

**命令用法**

```text
sudo [选项] <命令>
```



![img](https://pic3.zhimg.com/80/v2-944cf8bd5b08e2aa98923288b9c81912_hd.jpg)

------

## **三、组管理**

## **3.1 组的概述**

组是一类特殊账户，指具有相同或者相似特性的用户集合。

一个用户可以同时属于多个组，其中某个组为该用户的主要组，其他组为该用户的附加组。

而主要组是在用户登录时默认使用的组身份。在创建文件或目录时，若不指定属主，默认使用该组身份。

组的分类以及组 ID 的分布情况与用户基本一致。

每一个组可以由 `root` 指定一个或多个组管理员。

管理员可以添加或删除组中的成员。所有组管理员共用一个管理员密码。

组管理员可以是系统中的任意账户，可以不是组中的成员。

## **3.2 查看本机组信息**

## **3.2.1 /etc/group**

文件的格式如下：

```text
root:x:0:
bin:x:1:
...
```

该文件以 : 作为字段分隔符，保存了本机组的基本信息。以下详细说明其含义。

![img](https://pic4.zhimg.com/80/v2-d7c33fb9403bfa780d55046fecde06f3_hd.jpg)

在早期的 Linux 系统中，组管理员密码是保存在这个文件里的。但是该文件默认所有用户都可读，会对系统安全造成威胁。现在，密码都以散列的形式存储在了 /etc/gshadow 中了。

## **3.2.2 /etc/gshadow**

文件的格式如下：

```text
root:::
bin:::
...
```

该文件默认的权限为 200，也就是只有 root 有写权限（root 也肯定可以读）。

该文件同样以 : 作为字段分隔符，保存了本机所有组的组管理员以及管理员密码。以下详细说明其含义。



![img](https://pic1.zhimg.com/80/v2-90012db4207cf391728555cf2c44ef14_hd.jpg)

## **3.3 添加组**

**命令用法**

```text
groupadd [选项] <组名>
```

![img](https://pic3.zhimg.com/80/v2-5a53502a07f1218966db744a59d33096_hd.jpg)

## **3.4 删除组**

**命令用法**

```text
groupdel <组名>
```

## **3.5 修改组参数**

**命令用法**

```text
groupmod [选项] <组名>
```



![img](https://pic3.zhimg.com/80/v2-10f6893dbe695513b333bb6e2c4ddbde_hd.jpg)

## **3.6 组成员管理**

## **3.6.1 添加一个成员到组中**

**命令用法**

```text
gpasswd -a <用户名> <组名>
```

## **3.6.2 从组中删除一个成员**

**命令用法**

```text
gpasswd -d <用户名> <组名>
```

## **3.6.3 设置组成员列表**

**命令用法**

```text
gpasswd -M <用户名1>[,<用户名2>,...] <组名>
```

## **3.6.4 设置组管理员列表**

**命令用法**

```text
gpasswd -A <用户名1>[,<用户名2>,...] <组名>
```

## **3.6.5 设置组管理员密码**

**命令用法**

```text
gpasswd <组名>
```

## **3.6.6 删除组管理员密码**

**命令用法**

```text
gpasswd -r <组名>
```

## **3.6.7 查看用户加入的组**

**命令用法**

```text
groups [用户名]
```

若不指定用户名，则查看当前用户加入的组。

## **3.7 切换用户当前的组身份**

**命令用法**

```text
newgrp <组名>
```

> 转自: [CentOS 7 用户 & 组管理](<https://zhuanlan.zhihu.com/p/30252309>)