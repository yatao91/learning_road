## 使用wrk对flask HTTP api进行压力测试

#### 测试条件

测试条件: 线程-10 测试持续时间-60s 所有开启的HTTP连接数-200

#### 测试命令

`wrk -t10 -d60 -c200 http://192.168.33.20:5000/hello`

#### flask各服务器测试结果对比

| 启动参数                           | 并发请求 | 总请求数 | 超时请求数 | 超时占比 | 平均响应时间 |
| ---------------------------------- | -------- | -------- | ---------- | -------- | ------------ |
| 内置server                         | 200      | 1822     | 537        | 29.5%    | 1.29s        |
| gunicorn 单核                      | 200      | 3879     | 1060       | 27.3%    | 1.19s        |
| gunicorn 单核 + 2-gthread          | 200      | 7022     | 81         | 1.2%     | 1.67s        |
| gunicorn 单核 + gevent             | 200      | 6996     | 320        | 4.6%     | 1.65s        |
| gunicorn 单核 + 2-gthread + gevent | 200      | 6927     | 125        | 1.8%     | 1.67s        |
| gunicorn 双核 + gevent             | 200      | 6888     | 576        | 8.3%     | 1.66s        |
| gunicorn 双核 + gevent             | 400      | 6847     | 6197       | 90.5%    | 818ms        |
| gunicorn 四核 + gevent             | 400      | 6816     | 4844       | 71.1%    | 1.50s        |
| gunicorn 双核 + 2-gthread + gevent | 200      | 6747     | 3171       | 47%      | 1.33s        |
| gunicorn 双核 + 2-gthread + gevent | 400      | 6502     | 5860       | 90%      | 739ms        |

