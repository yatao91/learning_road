# MD5加密算法

### 1. 简介

> MD5的全称是Message-Digest Algorithm 5（信息-摘要算法），在90年代初由MIT Laboratory for
>  Computer Science和RSA Data Security Inc的Ronald L.
>  Rivest开发出来，经MD2、MD3和MD4发展而来。
>
> 一种被广泛使用的密码散列函数, 可以产生一个128位(16字节)的散列值(hash value), 用于确保信息传输完整一致.
>
> 将数据(如一段文字)运算变为另一固定长度,是散列算法的核心原理.

### 2. 应用

MD5已经广泛使用在为文件传输提供一定的可靠性方面。例如，服务器预先提供一个MD5校验和，用户下载完文件以后，用MD5算法计算下载文件的MD5校验和，然后通过检查这两个校验和是否一致，就能判断下载的文件是否出错。

> MD5亦有应用于部分网上赌场以保证赌博的公平性，原理是系统先在玩家下注前已生成该局的结果，将该结果的字符串配合一组随机字符串利用MD5 加密，将该加密字符串于玩家下注前便显示给玩家，再在结果开出后将未加密的字符串显示给玩家，玩家便可利用MD5工具加密验证该字符串是否吻合。
>
> 例子: 在玩家下注骰宝前，赌场便先决定该局结果，假设生成的随机结果为4、5、 6大，赌场便会先利用MD5 加密“4, 5, 6”此字符串并于玩家下注前告诉玩家；由于赌场是无法预计玩家会下什么注，所以便能确保赌场不能作弊；当玩家下注完毕后，赌场便告诉玩家该原始字符串，即“4, 5, 6”，玩家便可利用MD5工具加密该字符串是否与下注前的加密字符串吻合。
>
> 该字符串一般会加上一组随机字符串（Random string），以防止玩家利用碰撞（Collision）解密字符串，但如使用超级计算机利用碰撞亦有可能从加上随机字符串的加密字符串中获取游戏结果。随机字符串的长度与碰撞的次数成正比关系，一般网上赌场使用的随机字符串是长于20字，有些网上赌场的随机字符串更长达500字，以增加解密难度。

### 3. MD5散列

一般128位的MD5散列被表示为32位十六进制数字.

```
下面是一个43位长的仅ASCII字母列的MD5散列
MD5("The quick brown fox jumps over the lazy dog") = 9e107d9d372bb6826bd81d3542a419d6
```

即使在原文中作一个小变化(比如用c取代d)其散列也会发生巨大的变化:

```
MD5("The quick brown fox jumps over the lazy cog") = 1055d3e698d289f2af8663725127bd4b
```

空文的散列为:

```
MD5("") = d41d8cd98f00b204e9800998ecf8427e
```

### 4. 缺陷(已被破解)

2009年，中国科学院的谢涛和冯登国仅用了220.96的碰撞算法复杂度，破解了MD5的碰撞抵抗，该攻击在普通计算机上运行只需要数秒钟

